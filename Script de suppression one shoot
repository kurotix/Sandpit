@echo off
setlocal enabledelayedexpansion

rem Spécifiez le chemin du dossier de départ
set "start_folder=C:\chemin\vers\p-toto"

rem Incrémentez le compteur des exécutions
set /a "execution_count+=1"

rem Créez un fichier de trace incrémenté
echo Exécution !execution_count! ok > C:\statut_clean_workspace\statut_!execution_count!.txt

rem Fonction récursive pour supprimer le contenu du dossier "workspace"
:delete_workspace_contents
for /d /r "%start_folder%" %%i in (p-*) do (
    set "current_folder=%%i\workspace"
    if exist "!current_folder!" (
        echo Suppression du contenu de !current_folder!
        del /q "!current_folder!\*" > nul 2>&1
        for /d %%j in ("!current_folder!\*") do rd /s /q "%%j" > nul 2>&1
    )
)

echo Suppression du contenu terminée.

endlocal
